name: FIREGEM_AVIS_IGNITION
on: [push, workflow_dispatch]

jobs:
  ignition:
    runs-on: ubuntu-latest
    steps:
      - name: System Entry
        uses: actions/checkout@v4

      # STEP 1: FLAT KEY THE INI
      # This preserves the "s o s" spaces in a physical file so shell can't break them
      - name: Hard-Code FVS Section
        run: |
          echo "[fire-gem]" > fire-gem.ini
          echo 'address="AVIS-DATALAKE/GEMINI/VERSION 2"' >> fire-gem.ini
          echo 'cmd="echo s o s && mkdir -p \"AVIS-DATALAKE/GEMINI/VERSION 2\""' >> fire-gem.ini
          echo "FVS_ANCHOR: fire-gem.ini pre-staged with hard-coded spaces."

      # STEP 2: LOAD FORGE TOOLS
      - name: Acquire Forge Tools
        run: |
          sudo apt-get update && sudo apt-get install -y nasm binutils

      # STEP 3: SPARK THE BASH CONTROLLER
      # We use the CD method to ground the pathing before execution
      - name: Spark Gemini V2 Forge
        run: |
          # Locate the forge.sh through the space-trap using quotes
          FORGE_PATH="AVIS-DATALAKE/GEMINI/VERSION 2/forge.sh"
          
          # Grant execution and fire
          chmod +x "$FORGE_PATH"
          "./$FORGE_PATH" "../../fire-gem.ini"
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
