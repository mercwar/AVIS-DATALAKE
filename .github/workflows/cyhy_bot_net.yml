name: CYHY Bot Networking & Report
on:
  push:
    paths:
      - 'dl/**' # Triggers when the datalake changes

jobs:
  gemini-v2-report:
    runs-on: ubuntu-latest # This is the "Linux" we are installing
    steps:
      - name: Checkout Datalake
        uses: actions/checkout@v4

      - name: CYHY Networking - Generate Bot Report
        env:
          MERC_G_PAT: ${{ secrets.MERC_G_PAT }}
        run: |
          # 1. Create Navigation Metadata
          REPORT_ID=$(date +%s)
          PAYLOAD="{\"X\": 10, \"Y\": 20, \"Z\": 5, \"Status\": \"SUCCESS_CYHY\"}"
          
          # 2. Encode to Base64 KB Pack
          B64_PACK=$(echo -n "$PAYLOAD" | base64)
          
          # 3. Network Push to Datalake via GitHub API
          curl -X PUT \
            -H "Authorization: Bearer $MERC_G_PAT" \
            -H "Accept: application/vnd.github.v3+json" \
            https://api.github.com{{ github.repository }}/contents/dl/comments/bot_nav_$REPORT_ID.cyhy \
            -d "{
              \"message\": \"CYHY Bot Success Report $REPORT_ID\",
              \"content\": \"$B64_PACK\"
            }"
