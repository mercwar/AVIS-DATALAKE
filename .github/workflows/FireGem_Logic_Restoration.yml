- name: FireGem Logic: Rebuilding KB from Staging
  run: |
    echo "FLAME ON: Committing code blocks to Datalake surfaces..."
    
    python3 -c "
    import os

    # 1. Check if staging exists (prevents empty file errors)
    if not os.path.exists('staging_area.tmp'):
        print('CRITICAL: staging_area.tmp is missing. KB source is empty.')
        exit(1)

    content = open('staging_area.tmp').read()
    target_path = 'dl/ui_components/active_interface.c'
    target_dir = os.path.dirname(target_path)

    # 2. FireGem Logic: Create missing directories automatically
    if not os.path.exists(target_dir):
        print(f'FIRE: Creating directory {target_dir}')
        os.makedirs(target_dir, exist_ok=True)

    # 3. Write the file
    print(f'FIRE: Writing {target_path}')
    with open(target_path, 'w') as f:
        f.write(content)
    "
    echo "FIRE COMPLETE: System Synchronized."
  shell: /usr/bin/bash -e {0}
  env:
    MERC_G_PAT: ${{ secrets.MERC_G_PAT }}
